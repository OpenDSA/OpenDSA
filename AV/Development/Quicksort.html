<!DOCTYPE html>
<html lang="en">
  <head>
    <title>JSAV Quicksort Slideshow</title>
    <link rel="stylesheet" href="../../lib/JSAV.css" type="text/css" media="screen" title="no title" charset="utf-8" />
    <style>
    #container {
      width: 98%;
      position: relative;
    }
    .jsavcounter {
      position: absolute;
      top: 15px;
    }
    .jsavcanvas { height: 330px; }
    </style>
  </head>
  <body>
    <h1>JSAV Quicksort Slideshow</h1>
  <div id="container">
    <div class="jsavcontrols"></div><span class="jsavcounter"></span>
    <p class="jsavoutput jsavline"></p>
    <div class="jsavcanvas"></div>
  </div>
  <style>
  </style>
    <script
       src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script src="../../lib/jquery.transit.js"></script>
    <script src="../../lib/raphael.js"></script>
    <script src="../../lib/JSAV.js"></script>
    
    <script src="functionalListProcessing_helper.js"></script>
    
    <script>
  (function() {
    var av = new JSAV("container");
    
    //js array used for init
    var list = [2, 6, 10, 7]; //list
    
    //code view of ListSizeHelper
    var sortHelperArray = [
    "List QuicksortHelper(List list)",
    "{",
    "    if( = ListSize(list) 1)",
    "        return list",
    "    else",
    "        return Quicksort(list, [], [], [], randomValueFromArray(list) )",
    "}" 
    ];
    var sortHelperCode = av.code(sortHelperArray);
    
    var sortHelperHighlighter = new CodeHighlighter(sortHelperCode,sortHelperArray.length);
    sortHelperHighlighter.lineHeight = 24.5;
    sortHelperHighlighter.setLabel(av,"Quicksort Public Helper Method");
    sortHelperHighlighter.highlightCurrent(1);
    
    var sortArray = [
    "List Quicksort(List list, less, equal, greater, pivotVal)",
    "{",
    "    if( > ListSize(list) 0)",
    "        if(< car(list) pivotVal)",
    "			 return Quicksort(cdr(list), cons(less,car(list)), equal, greater, pivotVal)",
    "        else if(= car(list) pivotVal)",
    "			 return Quicksort(cdr(list), less, cons(equal,car(list)), greater, pivotVal)",
    "        else if(> car(list) pivotVal)",
    "			 return Quicksort(cdr(list), less, equal, cons(greater,car(list)), pivotVal)",
    "    else",
    "        return AppendLists( QuicksortHelper(less), equal, QuicksortHelper(greater) )",
    "}" 
    ];
    var sortCode = av.code(sortArray);
    
    var sortHighlighter = new CodeHighlighter(sortCode,sortArray.length);
    sortHighlighter.lineHeight = 20;
    sortHighlighter.setLabel(av,"Quicksort Method");    
    
    var arrays = [
    	new ArrayObj(list, "List", "list"),
    	new ArrayObj([], "Less", "less"),
    	new ArrayObj([], "Equal", "equal"),
    	new ArrayObj([], "Greater", "greater")
    ];
    
	var vars = [
		new VarObj("Pivot Val","pivot", 0)
    ];
    
    var visuals = new VisualsController(arrays,vars,av);
    visuals.visualize();
    
    av.umsg("This slideshow will demonstrate the execution of the QuickSort method. ",{preserve: false});
    
    // Note: av.displayInit() will not affect the number of slides.
    // All that it will do is affect what you get to see on the
    
    // initial slide.
    av.displayInit();
    
    // ------------- Slide 2 ------------- //
    sortHelperHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? ",{preserve: false});
	av.step();
	
	// ------------- Slide 3 ------------- //
    sortHelperHighlighter.moveCurrentLine(5);
	av.umsg("No, so go to else. ",{preserve: false});
	av.step();
	
	// ------------- Slide 4 ------------- //
    sortHelperHighlighter.moveCurrentLine(6);
	av.umsg("return the result from quicksort. ",{preserve: false});
	av.step();
	
	// ------------- Slide 5 ------------- //
	sortHighlighter.reset();
    sortHighlighter.highlightCurrent(1);
    //change pivot
	visuals.updateVar("pivot",6);
	visuals.redraw();
	av.umsg("Choose a random element as pivot (we randomly chose 6) and pass in empty lists for the accumulators equal, less, and greater.",{preserve: false});
	av.step();
	
	// ------------- Slide 6 ------------- //
    sortHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? (Have we categorized all the elements?)",{preserve: false});
	av.step();
	
	// ------------- Slide 7 ------------- //
    sortHighlighter.moveCurrentLine(4);
	av.umsg("No. Is the first element (2) of the list less than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 8 ------------- //
    sortHighlighter.moveCurrentLine(5);
	av.umsg("Yes. Do the first recursive call, moving 2 from 'list' and to 'less'.",{preserve: false});
	av.step();
	
	// ------------- Slide 9 ------------- //
	//change list and var
	visuals.updateArray("list",[6,10,7]);
	visuals.updateArray("less",[2]);
	visuals.redraw();
	//
	sortHighlighter.reset();
    sortHighlighter.highlightCurrent(1);
	av.umsg("Recursive call #1. ",{preserve: false});
	av.step();
	
	// ------------- Slide 10 ------------- //
    sortHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? (Have we categorized all the elements?)",{preserve: false});
	av.step();
	
	// ------------- Slide 11 ------------- //
    sortHighlighter.moveCurrentLine(4);
	av.umsg("No. Is the first element (6) of the list less than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 12 ------------- //
    sortHighlighter.moveCurrentLine(6);
	av.umsg("No. Is the first element (6) of the list equal to the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 13 ------------- //
    sortHighlighter.moveCurrentLine(7);
	av.umsg("Do the second recursive call, moving 6 from 'list' and to 'equal'.",{preserve: false});
	av.step();
	
	// ------------- Slide 14 ------------- //
	//change list and var
	visuals.updateArray("list",[10,7]);
	visuals.updateArray("equal",[6]);
	visuals.redraw();
	//
	sortHighlighter.reset();
    sortHighlighter.highlightCurrent(1);
	av.umsg("Recursive call #2. ",{preserve: false});
	av.step();
	
	// ------------- Slide 15 ------------- //
    sortHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? (Have we categorized all the elements?)",{preserve: false});
	av.step();
	
	// ------------- Slide 16 ------------- //
    sortHighlighter.moveCurrentLine(4);
	av.umsg("No. Is the first element (10) of the list less than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 17 ------------- //
    sortHighlighter.moveCurrentLine(6);
	av.umsg("No. Is the first element (10) of the list equal to the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 18 ------------- //
    sortHighlighter.moveCurrentLine(9);
	av.umsg("No. Is the first element (10) of the list greater than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 19 ------------- //
    sortHighlighter.moveCurrentLine(7);
	av.umsg("Yes. Do the third recursive call, moving 10 from 'list' and to 'greater'.",{preserve: false});
	av.step();
	
	// ------------- Slide 20 ------------- //
	//change list and var
	visuals.updateArray("list",[7]);
	visuals.updateArray("greater",[10]);
	visuals.redraw();
	//
	sortHighlighter.reset();
    sortHighlighter.highlightCurrent(1);
	av.umsg("Recursive call #3. ",{preserve: false});
	av.step();
	
	// ------------- Slide 21 ------------- //
    sortHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? (Have we categorized all the elements?)",{preserve: false});
	av.step();
	
	// ------------- Slide 22 ------------- //
    sortHighlighter.moveCurrentLine(5);
	av.umsg("No. Is the first element (7) of the list less than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 23 ------------- //
    sortHighlighter.moveCurrentLine(7);
	av.umsg("No. Is the first element (7) of the list equal to the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 24 ------------- //
    sortHighlighter.moveCurrentLine(9);
	av.umsg("No. Is the first element (7) of the list greater than the pivot? (6)",{preserve: false});
	av.step();
	
	// ------------- Slide 25 ------------- //
    sortHighlighter.moveCurrentLine(7);
	av.umsg("Yes. Do the fourth recursive call, moving 7 from 'list' and to 'greater'.",{preserve: false});
	av.step();
	
	// ------------- Slide 26 ------------- //
	//change list and var
	visuals.updateArray("list",[]);
	visuals.updateArray("greater",[10,7]);
	visuals.redraw();
	//
	sortHighlighter.reset();
    sortHighlighter.highlightCurrent(1);
	av.umsg("Recursive call #4. ",{preserve: false});
	av.step();
	
	// ------------- Slide 27 ------------- //
    sortHighlighter.moveCurrentLine(3);
	av.umsg("Is the list empty? (Have we categorized all the elements?)",{preserve: false});
	av.step();
	
	// ------------- Slide 29 ------------- //
    sortHighlighter.moveCurrentLine(10);
	av.umsg("Yes. Move to else. ",{preserve: false});
	av.step();
	
	// ------------- Slide 30 ------------- //
    sortHighlighter.moveCurrentLine(11);
	av.umsg("Return the 3 categorized lists, after calling quicksort on them, and appending them in order. The lists 'less', and 'equal' are trivially returned in the subsequent calls, while the greater list has 2 elements. The elements in this will be swapped when this call returns.",{preserve: false});
	av.step();
	
	// ------------- Slide 31 ------------- //
    sortHighlighter.moveCurrentLine(11);
    //change greater
	visuals.updateArray("greater",[7,10]);
	visuals.redraw();
	av.umsg("After the 'greater' list is sorted, we append the 3 lists and return them up the call stack.",{preserve: false});
	av.step();
	
	// ------------- Slide 32 ------------- //
    sortHighlighter.moveCurrentLine(11);
    //change greater
	visuals.updateArray("list",[2,6]);
	visuals.redraw();
	av.umsg("The 'less' and 'equal' lists are joined and is represented as 'list'",{preserve: false});
	av.step();
	
	// ------------- Slide 33 ------------- //
    sortHighlighter.moveCurrentLine(11);
    //change greater
	visuals.updateArray("list",[2,6,7,10]);
	visuals.redraw();
	av.umsg("Finally, the current 'list' is joined with the 'greater' list. This new list is then returned up the call stack, directly. ",{preserve: false});
	av.step();
	
    //done with av, record av actions
    av.recorded();
    
    //console.log("AV done being recorded.");
    
}());
    </script>
  </body>
</html>
